<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenLink | Encuentra puntos de reciclaje en San Ramón</title>
    <!-- Bootstrap CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Leaflet CSS (Mapa) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🌱</text></svg>">
    <!-- Style CSS -->
    <style>
        :root {
            --primary-green: #2ecc71;
            --secondary-green: #27ae60;
            --dark-green: #16a085;
            --light-gray: #f8f9fa;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-gray);
        }
        
        .navbar {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .navbar-brand {
            font-weight: 700;
            color: var(--dark-green) !important;
        }
        
        .btn-green {
            background-color: var(--primary-green);
            color: white;
            border: none;
        }
        
        .btn-green:hover {
            background-color: var(--secondary-green);
            color: white;
        }
        
        .hero-section {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.9), rgba(22, 160, 133, 0.9));
            color: white;
            padding: 5rem 0;
            margin-bottom: 3rem;
        }
        
        .feature-icon {
            font-size: 2.5rem;
            color: var(--primary-green);
            margin-bottom: 1rem;
        }
        
        .feature-card {
            transition: transform 0.3s;
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .map-container {
            height: 400px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        footer {
            background-color: #343a40;
            color: white;
            padding: 3rem 0;
            margin-top: 3rem;
        }
        
        .recycling-stats {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-green);
        }
        
        .material-badge {
            display: inline-block;
            padding: 0.35em 0.65em;
            font-size: 0.75em;
            font-weight: 700;
            line-height: 1;
            color: #fff;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 0.25rem;
        }
        
        .badge-plastic {
            background-color: #e67e22;
        }
        
        .badge-paper {
            background-color: #3498db;
        }
        
        .badge-glass {
            background-color: #16a085;
        }
        
        .badge-metal {
            background-color: #7f8c8d;
        }
        
        .badge-ewaste {
            background-color: #9b59b6;
        }

        /* Ajustes para alinear el botón en la navbar */
        .navbar-nav .nav-item {
            display: flex;
            align-items: center;
        }

        /* Ajuste específico para el botón en móviles */
        @media (max-width: 991.98px) {
            .navbar-nav .nav-item.ms-lg-3 {
                margin-left: 0 !important;
                padding: 0.5rem 1rem;
            }
        }

        /* Estilos para el mapa de Leaflet */
        .leaflet-popup-content h6 {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .leaflet-popup-content p {
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-leaf me-2"></i>GreenLink
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#mapa">Mapa</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#como-funciona">Cómo funciona</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#estadisticas">Estadísticas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#materiales">Materiales</a>
                    </li>
                    <li class="nav-item ms-lg-3 my-auto">
                        <a class="btn btn-green btn-sm" href="#registro">Regístrate</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Sección Hero -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4">Encuentra puntos de reciclaje en San Ramón</h1>
                    <p class="lead mb-4">Conectamos a la comunidad con los centros de reciclaje más cercanos para fomentar un entorno más limpio y sostenible.</p>
                    <div class="d-flex gap-3">
                        <a href="#mapa" class="btn btn-light btn-lg">Ver Mapa</a>
                        <a href="#registro" class="btn btn-outline-light btn-lg">Registrar Punto</a>
                    </div>
                </div>
                <div class="col-lg-6 d-none d-lg-block">
                    <img src="https://images.unsplash.com/photo-1606787366850-de6330128bfc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80" alt="Reciclaje" class="img-fluid rounded shadow">
                </div>
            </div>
        </div>
    </section>

    <!-- sección info -->
    <section class="container mb-5" id="como-funciona">
        <h2 class="text-center mb-5">¿Cómo funciona GreenLink?</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="feature-card card h-100 p-4 text-center">
                    <div class="feature-icon">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                    <h3>1. Encuentra</h3>
                    <p>Busca en nuestro mapa interactivo los puntos de reciclaje más cercanos a tu ubicación.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card card h-100 p-4 text-center">
                    <div class="feature-icon">
                        <i class="fas fa-recycle"></i>
                    </div>
                    <h3>2. Recicla</h3>
                    <p>Lleva tus materiales reciclables al punto más conveniente y ayuda al medio ambiente.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card card h-100 p-4 text-center">
                    <div class="feature-icon">
                        <i class="fas fa-plus-circle"></i>
                    </div>
                    <h3>3. Contribuye</h3>
                    <p>Registra nuevos puntos de reciclaje y comparte información con la comunidad.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Mapa -->
    <section class="container mb-5" id="mapa">
        <div class="row">
            <div class="col-lg-8">
                <h2 class="mb-4">Mapa de Puntos de Reciclaje</h2>
                <div class="map-container mb-4" id="map">
                    <!-- Mapa se cargará aquí con Leaflet -->
                </div>
                <div class="d-flex flex-wrap gap-2 mb-3">
                    <button class="btn btn-outline-secondary btn-sm filter-btn active" data-filter="all">Todos</button>
                    <button class="btn btn-outline-secondary btn-sm filter-btn" data-filter="plastic">
                        <i class="fas fa-trash-alt me-1"></i> Plástico
                    </button>
                    <button class="btn btn-outline-secondary btn-sm filter-btn" data-filter="paper">
                        <i class="fas fa-newspaper me-1"></i> Papel
                    </button>
                    <button class="btn btn-outline-secondary btn-sm filter-btn" data-filter="glass">
                        <i class="fas fa-wine-bottle me-1"></i> Vidrio
                    </button>
                    <button class="btn btn-outline-secondary btn-sm filter-btn" data-filter="metal">
                        <i class="fas fa-car-battery me-1"></i> Metal
                    </button>
                    <button class="btn btn-outline-secondary btn-sm filter-btn" data-filter="ewaste">
                        <i class="fas fa-laptop me-1"></i> Electrónicos
                    </button>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Filtrar por comuna</h5>
                        <div class="mb-3">
                            <select class="form-select" id="comuna-filter">
                                <option value="all">Todas las comunas</option>
                                <option value="san-ramon">San Ramón</option>
                                <option value="la-pintana">La Pintana</option>
                                <option value="la-granja">La Granja</option>
                                <option value="el-bosque">El Bosque</option>
                            </select>
                        </div>
                        <h5 class="card-title mt-4">Puntos cercanos</h5>
                        <div class="list-group" id="nearby-locations">
                            <!-- Los puntos cercanos se cargarán dinámicamente -->
                        </div>
                        <button class="btn btn-green w-100 mt-3" data-bs-toggle="modal" data-bs-target="#addLocationModal">
                            <i class="fas fa-plus me-2"></i>Agregar nuevo punto
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Estadisticas-->
    <section class="container mb-5" id="estadisticas">
        <h2 class="text-center mb-5">Impacto en la comunidad</h2>
        <div class="recycling-stats">
            <div class="row text-center">
                <div class="col-md-3">
                    <div class="stat-number" id="users-count">1,250</div>
                    <p>Usuarios registrados</p>
                </div>
                <div class="col-md-3">
                    <div class="stat-number" id="locations-count">87</div>
                    <p>Puntos de reciclaje</p>
                </div>
                <div class="col-md-3">
                    <div class="stat-number" id="recycled-count">42.5</div>
                    <p>Toneladas recicladas</p>
                </div>
                <div class="col-md-3">
                    <div class="stat-number" id="co2-count">98</div>
                    <p>Ton CO₂ evitadas</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Materiales -->
    <section class="container mb-5" id="materiales">
        <h2 class="text-center mb-5">Materiales que puedes reciclar</h2>
        <div class="row g-4">
            <div class="col-md-6 col-lg-3">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <span class="material-badge badge-plastic mb-3" style="font-size: 1.5rem; padding: 0.5rem 1rem;">
                            <i class="fas fa-trash-alt me-2"></i>Plástico
                        </span>
                        <ul class="text-start ps-3">
                            <li>Botellas PET (agua, bebidas)</li>
                            <li>Envases de limpieza</li>
                            <li>Bolsas plásticas (limpias)</li>
                            <li>Tapas de botellas</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <span class="material-badge badge-paper mb-3" style="font-size: 1.5rem; padding: 0.5rem 1rem;">
                            <i class="fas fa-newspaper me-2"></i>Papel
                        </span>
                        <ul class="text-start ps-3">
                            <li>Periódicos y revistas</li>
                            <li>Cajas de cartón</li>
                            <li>Papel de oficina</li>
                            <li>Libretas y cuadernos</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <span class="material-badge badge-glass mb-3" style="font-size: 1.5rem; padding: 0.5rem 1rem;">
                            <i class="fas fa-wine-bottle me-2"></i>Vidrio
                        </span>
                        <ul class="text-start ps-3">
                            <li>Botellas de bebidas</li>
                            <li>Frascos de alimentos</li>
                            <li>Envases de perfumes</li>
                            <li>Tarros de conservas</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <span class="material-badge badge-ewaste mb-3" style="font-size: 1.5rem; padding: 0.5rem 1rem;">
                            <i class="fas fa-laptop me-2"></i>Electrónicos
                        </span>
                        <ul class="text-start ps-3">
                            <li>Celulares y tablets</li>
                            <li>Computadores</li>
                            <li>Baterías</li>
                            <li>Cables y cargadores</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Registrarse -->
    <section class="container mb-5" id="registro">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card shadow">
                    <div class="card-body p-5">
                        <h2 class="text-center mb-4">Únete a GreenLink</h2>
                        <p class="text-center mb-4">Regístrate para guardar tus puntos favoritos, agregar nuevos centros de reciclaje y recibir actualizaciones.</p>
                        <form id="registrationForm">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="name" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="name" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Correo electrónico</label>
                                    <input type="email" class="form-control" id="email" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="password" class="form-label">Contraseña</label>
                                    <input type="password" class="form-control" id="password" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="comuna" class="form-label">Comuna</label>
                                    <select class="form-select" id="comuna" required>
                                        <option value="">Selecciona tu comuna</option>
                                        <option value="san-ramon">San Ramón</option>
                                        <option value="la-pintana">La Pintana</option>
                                        <option value="la-granja">La Granja</option>
                                        <option value="el-bosque">El Bosque</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="terms" required>
                                        <label class="form-check-label" for="terms">
                                            Acepto los <a href="#">términos y condiciones</a>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-12 text-center mt-3">
                                    <button type="submit" class="btn btn-green btn-lg px-5">Registrarse</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Add Location Modal -->
    <div class="modal fade" id="addLocationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Agregar nuevo punto de reciclaje</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addLocationForm">
                        <div class="mb-3">
                            <label for="locationName" class="form-label">Nombre del lugar</label>
                            <input type="text" class="form-control" id="locationName" required>
                        </div>
                        <div class="mb-3">
                            <label for="locationAddress" class="form-label">Dirección</label>
                            <input type="text" class="form-control" id="locationAddress" required>
                        </div>
                        <div class="mb-3">
                            <label for="locationComuna" class="form-label">Comuna</label>
                            <select class="form-select" id="locationComuna" required>
                                <option value="">Selecciona una comuna</option>
                                <option value="san-ramon">San Ramón</option>
                                <option value="la-pintana">La Pintana</option>
                                <option value="la-granja">La Granja</option>
                                <option value="el-bosque">El Bosque</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Materiales aceptados</label>
                            <div class="d-flex flex-wrap gap-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="plasticCheck" value="plastic">
                                    <label class="form-check-label" for="plasticCheck">Plástico</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="paperCheck" value="paper">
                                    <label class="form-check-label" for="paperCheck">Papel</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="glassCheck" value="glass">
                                    <label class="form-check-label" for="glassCheck">Vidrio</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="metalCheck" value="metal">
                                    <label class="form-check-label" for="metalCheck">Metal</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="ewasteCheck" value="ewaste">
                                    <label class="form-check-label" for="ewasteCheck">Electrónicos</label>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="locationHours" class="form-label">Horario de atención</label>
                            <input type="text" class="form-control" id="locationHours" placeholder="Ej: Lunes a Viernes 9:00-18:00">
                        </div>
                        <div class="mb-3">
                            <label for="locationPhoto" class="form-label">Foto (opcional)</label>
                            <input type="file" class="form-control" id="locationPhoto" accept="image/*">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-green" id="submitLocationBtn">Enviar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4 mb-lg-0">
                    <h5 class="mb-3">
                        <i class="fas fa-leaf me-2"></i>GreenLink
                    </h5>
                    <p>Conectando a la comunidad con puntos de reciclaje en San Ramón y sus alrededores para un futuro más sostenible.</p>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-white"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6 mb-4 mb-md-0">
                    <h5 class="mb-3">Enlaces</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#mapa" class="text-white text-decoration-none">Mapa</a></li>
                        <li class="mb-2"><a href="#como-funciona" class="text-white text-decoration-none">Cómo funciona</a></li>
                        <li class="mb-2"><a href="#estadisticas" class="text-white text-decoration-none">Estadísticas</a></li>
                        <li class="mb-2"><a href="#materiales" class="text-white text-decoration-none">Materiales</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                    <h5 class="mb-3">Comunidades</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">San Ramón</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">La Pintana</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">La Granja</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">El Bosque</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5 class="mb-3">Contacto</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-envelope me-2"></i> contacto@greenlink.cl</li>
                        <li class="mb-2"><i class="fas fa-phone me-2"></i> +56 9 1234 5678</li>
                        <li class="mb-2"><i class="fas fa-map-marker-alt me-2"></i> San Ramón, Santiago</li>
                    </ul>
                </div>
            </div>
            <hr class="my-4 bg-light">
            <div class="row">
                <div class="col-md-6 text-center text-md-start">
                    <p class="small mb-0">&copy; 2025 GreenLink. Todos los derechos reservados.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="small mb-0">
                        <a href="#" class="text-white text-decoration-none">Política de privacidad</a> | 
                        <a href="#" class="text-white text-decoration-none">Términos de servicio</a>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Custom JS -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ====================== MAPA INTERACTIVO ======================
            // Coordenadas de San Ramón
            const sanRamonCoords = [-33.5345, -70.6206];
            
            // Inicializar mapa
            const map = L.map('map').setView(sanRamonCoords, 14);
            
            // Añadir capa de OpenStreetMap
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(map);
            
            // Icono personalizado para los marcadores
            const recyclingIcon = L.icon({
                iconUrl: 'https://cdn-icons-png.flaticon.com/512/3063/3063187.png',
                iconSize: [32, 32],
                iconAnchor: [16, 32],
                popupAnchor: [0, -32]
            });
            
            // Datos de ejemplo (en un proyecto real, estos vendrían de una API o base de datos)
            const recyclingPoints = [
                {
                    id: 1,
                    name: "Punto Limpio San Ramón",
                    address: "Av. Concha y Toro 5720",
                    comuna: "san-ramon",
                    coords: [-33.5345, -70.6206],
                    materials: ["Plástico", "Papel", "Vidrio"],
                    schedule: "Lunes a Viernes 9:00-18:00",
                    distance: "1.2 km"
                },
                {
                    id: 2,
                    name: "Reciclaje Electrónico",
                    address: "Av. Santa Rosa 1234",
                    comuna: "san-ramon",
                    coords: [-33.5300, -70.6150],
                    materials: ["Electrónicos", "Metal"],
                    schedule: "Martes a Sábado 10:00-17:00",
                    distance: "2.5 km"
                },
                {
                    id: 3,
                    name: "Centro de Acopio La Granja",
                    address: "Av. San Francisco 8765",
                    comuna: "la-granja",
                    coords: [-33.5400, -70.6100],
                    materials: ["Plástico", "Papel", "Vidrio", "Metal"],
                    schedule: "Lunes a Domingo 8:00-20:00",
                    distance: "3.1 km"
                }
            ];
            
            // Añadir marcadores al mapa
            const markers = [];
            recyclingPoints.forEach(point => {
                const marker = L.marker(point.coords, { 
                    icon: recyclingIcon,
                    title: point.name
                }).addTo(map);
                
                // Contenido del popup
                const popupContent = `
                    <h6 class="mb-1">${point.name}</h6>
                    <p class="mb-2"><small>${point.address}</small></p>
                    <p class="mb-1"><strong>Horario:</strong> ${point.schedule}</p>
                    <div class="d-flex flex-wrap gap-1 mt-2">
                        ${point.materials.map(material => 
                            `<span class="material-badge ${getBadgeClass(material)}">${material}</span>`
                        ).join('')}
                    </div>
                `;
                
                marker.bindPopup(popupContent);
                
                // Guardar referencia y datos adicionales
                marker.pointData = point;
                markers.push(marker);
            });
            
            // Función para obtener clase CSS según el material
            function getBadgeClass(material) {
                const classes = {
                    "Plástico": "badge-plastic",
                    "Papel": "badge-paper",
                    "Vidrio": "badge-glass",
                    "Metal": "badge-metal",
                    "Electrónicos": "badge-ewaste"
                };
                return classes[material] || "badge-secondary";
            }
            
            // Cargar puntos cercanos en la lista
            function loadNearbyLocations() {
                const nearbyList = document.getElementById('nearby-locations');
                nearbyList.innerHTML = '';
                
                recyclingPoints.forEach(point => {
                    const item = document.createElement('div');
                    item.className = 'list-group-item';
                    item.innerHTML = `
                        <div class="d-flex w-100 justify-content-between">
                            <h6 class="mb-1">${point.name}</h6>
                            <small class="text-muted">${point.distance}</small>
                        </div>
                        <p class="mb-1 small">${point.address}</p>
                        <div class="d-flex flex-wrap gap-1 mt-1">
                            ${point.materials.map(material => 
                                `<span class="material-badge ${getBadgeClass(material)}">${material}</span>`
                            ).join('')}
                        </div>
                    `;
                    
                    // Al hacer clic, centrar el mapa en ese punto
                    item.addEventListener('click', () => {
                        map.setView(point.coords, 16);
                        markers.find(m => m.pointData.id === point.id).openPopup();
                    });
                    
                    nearbyList.appendChild(item);
                });
            }
            
            // Filtrar puntos por material
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remover clase active de todos los botones
                    document.querySelectorAll('.filter-btn').forEach(b => 
                        b.classList.remove('active'));
                    
                    // Añadir clase active al botón clickeado
                    this.classList.add('active');
                    
                    const filter = this.getAttribute('data-filter');
                    
                    markers.forEach(marker => {
                        if (filter === 'all') {
                            marker.addTo(map);
                        } else {
                            const materials = marker.pointData.materials.map(m => m.toLowerCase());
                            if (materials.includes(filter)) {
                                marker.addTo(map);
                            } else {
                                map.removeLayer(marker);
                            }
                        }
                    });
                });
            });
            
            // Filtrar por comuna
            document.getElementById('comuna-filter').addEventListener('change', function() {
                const comuna = this.value;
                
                markers.forEach(marker => {
                    if (comuna === 'all' || marker.pointData.comuna === comuna) {
                        marker.addTo(map);
                    } else {
                        map.removeLayer(marker);
                    }
                });
            });
            
            // Cargar lista de puntos cercanos
            loadNearbyLocations();
            
            // ====================== ANIMACIÓN DE ESTADÍSTICAS ======================
            function animateValue(id, start, end, duration) {
                const obj = document.getElementById(id);
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    const value = Math.floor(progress * (end - start) + start);
                    obj.innerHTML = id === 'recycled-count' || id === 'co2-count' ? 
                                  value.toFixed(1) : value.toLocaleString();
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    }
                };
                window.requestAnimationFrame(step);
            }
            
            // Animar cuando la sección sea visible
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        animateValue('users-count', 0, 1250, 2000);
                        animateValue('locations-count', 0, 87, 1500);
                        animateValue('recycled-count', 0, 42.5, 2000);
                        animateValue('co2-count', 0, 98, 2000);
                        observer.unobserve(entry.target);
                    }
                });
            }, {threshold: 0.5});
            
            observer.observe(document.getElementById('estadisticas'));
            
            // ====================== FORMULARIOS ======================
            // Registro de usuario
            document.getElementById('registrationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('¡Gracias por registrarte en GreenLink! Te hemos enviado un correo de confirmación.');
                this.reset();
            });
            
            // Agregar nuevo punto
            document.getElementById('submitLocationBtn').addEventListener('click', function() {
                const form = document.getElementById('addLocationForm');
                if (form.checkValidity()) {
                    alert('¡Gracias por contribuir! Tu punto de reciclaje será revisado y publicado pronto.');
                    const modal = bootstrap.Modal.getInstance(document.getElementById('addLocationModal'));
                    modal.hide();
                    form.reset();
                } else {
                    form.reportValidity();
                }
            });
            
            // ====================== SCROLL SUAVE ======================
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        window.scrollTo({
                            top: target.offsetTop - 70,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // ====================== GEOLOCALIZACIÓN ======================
            if (navigator.geolocation) {
                const geoBtn = document.createElement('button');
                geoBtn.className = 'btn btn-outline-primary btn-sm ms-2';
                geoBtn.innerHTML = '<i class="fas fa-location-arrow me-1"></i>Mi ubicación';
                geoBtn.addEventListener('click', () => {
                    navigator.geolocation.getCurrentPosition(position => {
                        map.setView([position.coords.latitude, position.coords.longitude], 15);
                    }, () => {
                        alert('No se pudo obtener tu ubicación. Asegúrate de haber permitido el acceso.');
                    });
                });
                
                document.querySelector('.map-container').appendChild(geoBtn);
            }
        });
    </script>
</body>
</html>